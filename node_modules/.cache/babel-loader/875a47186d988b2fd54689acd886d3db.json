{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport ContainerRender from 'rc-util/es/ContainerRender';\nimport getScrollBarSize from 'rc-util/es/getScrollBarSize';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport { dataToArray, transitionEnd, transitionStr, addEventListener, removeEventListener, transformArguments, isNumeric } from './utils';\nvar IS_REACT_16 = ('createPortal' in ReactDOM);\nvar currentDrawer = {};\nvar windowIsUndefined = !(typeof window !== 'undefined' && window.document && window.document.createElement);\n\nvar Drawer = function (_React$PureComponent) {\n  _inherits(Drawer, _React$PureComponent);\n\n  function Drawer(props) {\n    _classCallCheck(this, Drawer);\n\n    var _this = _possibleConstructorReturn(this, (Drawer.__proto__ || Object.getPrototypeOf(Drawer)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.levelDom = [];\n    _this.contentDom = null;\n    _this.maskDom = null;\n    _this.handlerDom = null;\n    _this.firstEnter = props.firstEnter; // 记录首次进入.\n\n    _this.timeout = null;\n    _this.drawerId = Number((Date.now() + Math.random()).toString().replace('.', Math.round(Math.random() * 9))).toString(16);\n    var open = props.open !== undefined ? props.open : !!props.defaultOpen;\n    currentDrawer[_this.drawerId] = open;\n    _this.state = {\n      open: open\n    };\n    return _this;\n  }\n\n  _createClass(Drawer, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (!windowIsUndefined) {\n        var passiveSupported = false;\n        window.addEventListener('test', null, Object.defineProperty({}, 'passive', {\n          get: function get() {\n            passiveSupported = true;\n            return null;\n          }\n        }));\n        this.passive = passiveSupported ? {\n          passive: false\n        } : false;\n      }\n\n      var open = this.getOpen();\n\n      if (this.props.handler || open || this.firstEnter) {\n        this.getDefault(this.props);\n\n        if (open) {\n          this.isOpenChange = true;\n        }\n\n        this.forceUpdate();\n      }\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var _this2 = this;\n\n      var open = nextProps.open,\n          placement = nextProps.placement,\n          getContainer = nextProps.getContainer;\n\n      if (open !== undefined && open !== this.props.open) {\n        this.isOpenChange = true; // 没渲染 dom 时，获取默认数据;\n\n        var getContainerBool = typeof getContainer === 'function' && typeof this.props.getContainer === 'function' ? this.props.getContainer() === getContainer() : this.props.getContainer === getContainer;\n\n        if (!this.container || !getContainerBool) {\n          this.getDefault(nextProps);\n        }\n\n        var focus = open && !this.props.open;\n        this.setState({\n          open: open\n        }, function () {\n          _this2.domFocus(focus);\n        });\n      }\n\n      if (placement !== this.props.placement) {\n        // test 的 bug, 有动画过场，删除 dom\n        this.contentDom = null;\n      }\n\n      if (this.props.level !== nextProps.level) {\n        this.getParentAndLevelDom(nextProps);\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      // dom 没渲染时，重走一遍。\n      if (!this.firstEnter && this.container) {\n        this.forceUpdate();\n        this.firstEnter = true;\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      delete currentDrawer[this.drawerId];\n      delete this.isOpenChange;\n\n      if (this.container) {\n        if (this.state.open) {\n          this.setLevelDomTransform(false, true);\n        }\n\n        document.body.style.overflow = ''; // 拦不住。。直接删除；\n\n        if (this.props.getContainer) {\n          this.container.parentNode.removeChild(this.container);\n        }\n      }\n\n      this.firstEnter = false;\n      clearTimeout(this.timeout); // suppport react15\n      // 需要 didmount 后也会渲染，直接 unmount 将不会渲染，加上判断.\n\n      if (this.renderComponent && !IS_REACT_16) {\n        this.renderComponent({\n          afterClose: this.removeContainer,\n          onClose: function onClose() {},\n          visible: false\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _props = this.props,\n          getContainer = _props.getContainer,\n          wrapperClassName = _props.wrapperClassName;\n      var open = this.getOpen();\n      currentDrawer[this.drawerId] = open ? this.container : open;\n      var children = this.getChildToRender(this.firstEnter ? open : false);\n\n      if (!getContainer) {\n        return React.createElement('div', {\n          className: wrapperClassName,\n          ref: function ref(c) {\n            if (_this3.props.getContainer) {\n              return;\n            }\n\n            _this3.container = c;\n          }\n        }, children);\n      }\n\n      if (!this.container || !open && !this.firstEnter) {\n        return null;\n      } // suppport react15\n\n\n      if (!IS_REACT_16) {\n        return React.createElement(ContainerRender, {\n          parent: this,\n          visible: true,\n          autoMount: true,\n          autoDestroy: false,\n          getComponent: function getComponent() {\n            return children;\n          },\n          getContainer: this.getContainer\n        }, function (_ref) {\n          var renderComponent = _ref.renderComponent,\n              removeContainer = _ref.removeContainer;\n          _this3.renderComponent = renderComponent;\n          _this3.removeContainer = removeContainer;\n          return null;\n        });\n      }\n\n      return ReactDOM.createPortal(children, this.container);\n    }\n  }]);\n\n  return Drawer;\n}(React.PureComponent);\n\nDrawer.propTypes = {\n  wrapperClassName: PropTypes.string,\n  className: PropTypes.string,\n  children: PropTypes.node,\n  style: PropTypes.object,\n  width: PropTypes.any,\n  height: PropTypes.any,\n  defaultOpen: PropTypes.bool,\n  firstEnter: PropTypes.bool,\n  open: PropTypes.bool,\n  prefixCls: PropTypes.string,\n  placement: PropTypes.string,\n  level: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n  levelMove: PropTypes.oneOfType([PropTypes.number, PropTypes.func, PropTypes.array]),\n  ease: PropTypes.string,\n  duration: PropTypes.string,\n  getContainer: PropTypes.oneOfType([PropTypes.string, PropTypes.func, PropTypes.object, PropTypes.bool]),\n  handler: PropTypes.any,\n  onChange: PropTypes.func,\n  afterVisibleChange: PropTypes.func,\n  onMaskClick: PropTypes.func,\n  onHandleClick: PropTypes.func,\n  showMask: PropTypes.bool,\n  maskStyle: PropTypes.object,\n  keyboard: PropTypes.bool\n};\nDrawer.defaultProps = {\n  prefixCls: 'drawer',\n  placement: 'left',\n  getContainer: 'body',\n  level: 'all',\n  duration: '.3s',\n  ease: 'cubic-bezier(0.78, 0.14, 0.15, 0.86)',\n  onChange: function onChange() {},\n  afterVisibleChange: function afterVisibleChange() {},\n  handler: React.createElement('div', {\n    className: 'drawer-handle'\n  }, React.createElement('i', {\n    className: 'drawer-handle-icon'\n  })),\n  firstEnter: false,\n  showMask: true,\n  maskStyle: {},\n  wrapperClassName: '',\n  className: '',\n  keyboard: true\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this4 = this;\n\n  this.onMaskTouchEnd = function (e) {\n    var onMaskClick = _this4.props.onMaskClick;\n\n    if (onMaskClick) {\n      onMaskClick(e);\n    }\n\n    _this4.onTouchEnd(e, true);\n  };\n\n  this.onIconTouchEnd = function (e) {\n    var onHandleClick = _this4.props.onHandleClick;\n\n    if (onHandleClick) {\n      onHandleClick(e);\n    }\n\n    _this4.onTouchEnd(e);\n  };\n\n  this.onTouchEnd = function (e, close) {\n    if (_this4.props.open !== undefined) {\n      return;\n    }\n\n    var open = close || _this4.state.open;\n    _this4.isOpenChange = true;\n\n    _this4.setState({\n      open: !open\n    }, function () {\n      _this4.domFocus(!open);\n    });\n  };\n\n  this.onKeyDown = function (e) {\n    if (e.keyCode === KeyCode.ESC) {\n      var _props2 = _this4.props,\n          onMaskClick = _props2.onMaskClick,\n          onHandleClick = _props2.onHandleClick;\n      e.stopPropagation();\n      var onClose = onHandleClick || onMaskClick;\n\n      if (onClose) {\n        onClose(e);\n      } else {\n        _this4.onTouchEnd(e, true);\n      }\n    }\n  };\n\n  this.onWrapperTransitionEnd = function (e) {\n    if (e.target === _this4.contentWrapper && e.propertyName.match(/transform$/)) {\n      _this4.dom.style.transition = '';\n\n      if (!_this4.state.open && _this4.getCurrentDrawerSome()) {\n        document.body.style.overflowX = '';\n\n        if (_this4.maskDom) {\n          _this4.maskDom.style.left = '';\n          _this4.maskDom.style.width = '';\n        }\n      }\n\n      var afterVisibleChange = _this4.props.afterVisibleChange;\n      var open = _this4.state.open;\n      afterVisibleChange(open);\n    }\n  };\n\n  this.getDefault = function (props) {\n    _this4.getParentAndLevelDom(props);\n\n    if (props.getContainer || props.parent) {\n      _this4.container = _this4.defaultGetContainer();\n    }\n  };\n\n  this.getCurrentDrawerSome = function () {\n    return !Object.keys(currentDrawer).some(function (key) {\n      return currentDrawer[key];\n    });\n  };\n\n  this.getContainer = function () {\n    return _this4.container;\n  };\n\n  this.getParentAndLevelDom = function (props) {\n    if (windowIsUndefined) {\n      return;\n    }\n\n    var level = props.level,\n        getContainer = props.getContainer;\n    _this4.levelDom = [];\n\n    if (getContainer) {\n      if (typeof getContainer === 'string') {\n        var dom = document.querySelectorAll(getContainer)[0];\n        _this4.parent = dom;\n      }\n\n      if (typeof getContainer === 'function') {\n        _this4.parent = getContainer();\n      }\n\n      if (typeof getContainer === 'object' && getContainer instanceof window.HTMLElement) {\n        _this4.parent = getContainer;\n      }\n    }\n\n    if (!getContainer && _this4.container) {\n      _this4.parent = _this4.container.parentNode;\n    }\n\n    if (level === 'all') {\n      var children = Array.prototype.slice.call(_this4.parent.children);\n      children.forEach(function (child) {\n        if (child.nodeName !== 'SCRIPT' && child.nodeName !== 'STYLE' && child.nodeName !== 'LINK' && child !== _this4.container) {\n          _this4.levelDom.push(child);\n        }\n      });\n    } else if (level) {\n      dataToArray(level).forEach(function (key) {\n        document.querySelectorAll(key).forEach(function (item) {\n          _this4.levelDom.push(item);\n        });\n      });\n    }\n  };\n\n  this.setLevelDomTransform = function (open, openTransition, placementName, value) {\n    var _props3 = _this4.props,\n        placement = _props3.placement,\n        levelMove = _props3.levelMove,\n        duration = _props3.duration,\n        ease = _props3.ease,\n        onChange = _props3.onChange,\n        getContainer = _props3.getContainer,\n        showMask = _props3.showMask;\n\n    if (!windowIsUndefined) {\n      var right = document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight) && window.innerWidth > document.body.offsetWidth ? getScrollBarSize(1) : 0;\n\n      _this4.levelDom.forEach(function (dom) {\n        if (_this4.isOpenChange || openTransition) {\n          /* eslint no-param-reassign: \"error\" */\n          dom.style.transition = 'transform ' + duration + ' ' + ease;\n          addEventListener(dom, transitionEnd, _this4.transitionEnd);\n          var levelValue = open ? value : 0;\n\n          if (levelMove) {\n            var $levelMove = transformArguments(levelMove, {\n              target: dom,\n              open: open\n            });\n            levelValue = open ? $levelMove[0] : $levelMove[1] || 0;\n          }\n\n          var $value = typeof levelValue === 'number' ? levelValue + 'px' : levelValue;\n          var placementPos = placement === 'left' || placement === 'top' ? $value : '-' + $value;\n          var mark = placement === 'left' || placement === 'top' ? '-' : '+';\n          placementPos = showMask && (placement === 'left' || placement === 'right') && right ? 'calc(' + placementPos + ' ' + mark + ' ' + right + 'px)' : placementPos;\n          dom.style.transform = levelValue ? placementName + '(' + placementPos + ')' : '';\n          dom.style.msTransform = levelValue ? placementName + '(' + placementPos + ')' : '';\n        }\n      }); // 处理 body 滚动\n\n\n      if (getContainer === 'body' && showMask) {\n        var eventArray = ['touchstart'];\n        var domArray = [document.body, _this4.maskDom, _this4.handlerDom, _this4.contentDom];\n        var widthTransition = 'width ' + duration + ' ' + ease;\n        var transformTransition = 'transform ' + duration + ' ' + ease;\n\n        if (open && document.body.style.overflow !== 'hidden') {\n          document.body.style.overflow = 'hidden';\n          document.body.style.touchAction = 'none';\n\n          if (right) {\n            document.body.style.position = 'relative';\n            document.body.style.width = 'calc(100% - ' + right + 'px)';\n            _this4.dom.style.transition = 'none';\n\n            switch (placement) {\n              case 'right':\n                _this4.dom.style.transform = 'translateX(-' + right + 'px)';\n                _this4.dom.style.msTransform = 'translateX(-' + right + 'px)';\n                break;\n\n              case 'top':\n              case 'bottom':\n                _this4.dom.style.width = 'calc(100% - ' + right + 'px)';\n                _this4.dom.style.transform = 'translateZ(0)';\n                break;\n\n              default:\n                break;\n            }\n\n            clearTimeout(_this4.timeout);\n            _this4.timeout = setTimeout(function () {\n              _this4.dom.style.transition = transformTransition + ',' + widthTransition;\n              _this4.dom.style.width = '';\n              _this4.dom.style.transform = '';\n              _this4.dom.style.msTransform = '';\n            });\n          } // 手机禁滚\n\n\n          domArray.forEach(function (item, i) {\n            if (!item) {\n              return;\n            }\n\n            addEventListener(item, eventArray[i] || 'touchmove', i ? _this4.removeMoveHandler : _this4.removeStartHandler, _this4.passive);\n          });\n        } else if (_this4.getCurrentDrawerSome()) {\n          document.body.style.overflow = '';\n          document.body.style.touchAction = '';\n\n          if ((_this4.isOpenChange || openTransition) && right) {\n            document.body.style.position = '';\n            document.body.style.width = '';\n\n            if (transitionStr) {\n              document.body.style.overflowX = 'hidden';\n            }\n\n            _this4.dom.style.transition = 'none';\n            var heightTransition = void 0;\n\n            switch (placement) {\n              case 'right':\n                {\n                  _this4.dom.style.transform = 'translateX(' + right + 'px)';\n                  _this4.dom.style.msTransform = 'translateX(' + right + 'px)';\n                  _this4.dom.style.width = '100%';\n                  widthTransition = 'width 0s ' + ease + ' ' + duration;\n\n                  if (_this4.maskDom) {\n                    _this4.maskDom.style.left = '-' + right + 'px';\n                    _this4.maskDom.style.width = 'calc(100% + ' + right + 'px)';\n                  }\n\n                  break;\n                }\n\n              case 'top':\n              case 'bottom':\n                {\n                  _this4.dom.style.width = 'calc(100% + ' + right + 'px)';\n                  _this4.dom.style.height = '100%';\n                  _this4.dom.style.transform = 'translateZ(0)';\n                  heightTransition = 'height 0s ' + ease + ' ' + duration;\n                  break;\n                }\n\n              default:\n                break;\n            }\n\n            clearTimeout(_this4.timeout);\n            _this4.timeout = setTimeout(function () {\n              _this4.dom.style.transition = transformTransition + ',' + (heightTransition ? heightTransition + ',' : '') + widthTransition;\n              _this4.dom.style.transform = '';\n              _this4.dom.style.msTransform = '';\n              _this4.dom.style.width = '';\n              _this4.dom.style.height = '';\n            });\n          }\n\n          domArray.forEach(function (item, i) {\n            if (!item) {\n              return;\n            }\n\n            removeEventListener(item, eventArray[i] || 'touchmove', i ? _this4.removeMoveHandler : _this4.removeStartHandler, _this4.passive);\n          });\n        }\n      }\n    }\n\n    if (_this4.isOpenChange && _this4.firstEnter) {\n      onChange(open);\n      _this4.isOpenChange = false;\n    }\n  };\n\n  this.getChildToRender = function (open) {\n    var _classnames;\n\n    var _props4 = _this4.props,\n        $wrapperClass = _props4.wrapperClassName,\n        className = _props4.className,\n        children = _props4.children,\n        style = _props4.style,\n        width = _props4.width,\n        height = _props4.height,\n        defaultOpen = _props4.defaultOpen,\n        firstEnter = _props4.firstEnter,\n        $open = _props4.open,\n        prefixCls = _props4.prefixCls,\n        placement = _props4.placement,\n        level = _props4.level,\n        levelMove = _props4.levelMove,\n        ease = _props4.ease,\n        duration = _props4.duration,\n        getContainer = _props4.getContainer,\n        handler = _props4.handler,\n        onChange = _props4.onChange,\n        afterVisibleChange = _props4.afterVisibleChange,\n        onMaskClick = _props4.onMaskClick,\n        onHandleClick = _props4.onHandleClick,\n        showMask = _props4.showMask,\n        maskStyle = _props4.maskStyle,\n        keyboard = _props4.keyboard,\n        props = _objectWithoutProperties(_props4, ['wrapperClassName', 'className', 'children', 'style', 'width', 'height', 'defaultOpen', 'firstEnter', 'open', 'prefixCls', 'placement', 'level', 'levelMove', 'ease', 'duration', 'getContainer', 'handler', 'onChange', 'afterVisibleChange', 'onMaskClick', 'onHandleClick', 'showMask', 'maskStyle', 'keyboard']);\n\n    var wrapperClassName = classnames(prefixCls, (_classnames = {}, _defineProperty(_classnames, prefixCls + '-' + placement, true), _defineProperty(_classnames, prefixCls + '-open', open), _defineProperty(_classnames, className, !!className), _defineProperty(_classnames, 'no-mask', !showMask), _classnames));\n    var isOpenChange = _this4.isOpenChange;\n    var isHorizontal = placement === 'left' || placement === 'right';\n    var placementName = 'translate' + (isHorizontal ? 'X' : 'Y'); // 百分比与像素动画不同步，第一次打用后全用像素动画。\n    // const defaultValue = !this.contentDom || !level ? '100%' : `${value}px`;\n\n    var placementPos = placement === 'left' || placement === 'top' ? '-100%' : '100%';\n    var transform = open ? '' : placementName + '(' + placementPos + ')';\n\n    if (isOpenChange === undefined || isOpenChange) {\n      var contentValue = _this4.contentDom ? _this4.contentDom.getBoundingClientRect()[isHorizontal ? 'width' : 'height'] : 0;\n      var value = (isHorizontal ? width : height) || contentValue;\n\n      _this4.setLevelDomTransform(open, false, placementName, value);\n    }\n\n    var handlerChildren = handler && React.cloneElement(handler, {\n      onClick: function onClick(e) {\n        if (handler.props.onClick) {\n          handler.props.onClick();\n        }\n\n        _this4.onIconTouchEnd(e);\n      },\n      ref: function ref(c) {\n        _this4.handlerDom = c;\n      }\n    });\n    return React.createElement('div', _extends({}, props, {\n      tabIndex: -1,\n      className: wrapperClassName,\n      style: style,\n      ref: function ref(c) {\n        _this4.dom = c;\n      },\n      onKeyDown: open && keyboard ? _this4.onKeyDown : null,\n      onTransitionEnd: _this4.onWrapperTransitionEnd\n    }), showMask && React.createElement('div', {\n      className: prefixCls + '-mask',\n      onClick: _this4.onMaskTouchEnd,\n      style: maskStyle,\n      ref: function ref(c) {\n        _this4.maskDom = c;\n      }\n    }), React.createElement('div', {\n      className: prefixCls + '-content-wrapper',\n      style: {\n        transform: transform,\n        msTransform: transform,\n        width: isNumeric(width) ? width + 'px' : width,\n        height: isNumeric(height) ? height + 'px' : height\n      },\n      ref: function ref(c) {\n        _this4.contentWrapper = c;\n      }\n    }, React.createElement('div', {\n      className: prefixCls + '-content',\n      ref: function ref(c) {\n        _this4.contentDom = c;\n      },\n      onTouchStart: open && showMask ? _this4.removeStartHandler : null // 跑用例用\n      ,\n      onTouchMove: open && showMask ? _this4.removeMoveHandler : null // 跑用例用\n\n    }, children), handlerChildren));\n  };\n\n  this.getOpen = function () {\n    return _this4.props.open !== undefined ? _this4.props.open : _this4.state.open;\n  };\n\n  this.getTouchParentScroll = function (root, currentTarget, differX, differY) {\n    if (!currentTarget || currentTarget === document) {\n      return false;\n    } // root 为 drawer-content 设定了 overflow, 判断为 root 的 parent 时结束滚动；\n\n\n    if (currentTarget === root.parentNode) {\n      return true;\n    }\n\n    var isY = Math.max(Math.abs(differX), Math.abs(differY)) === Math.abs(differY);\n    var isX = Math.max(Math.abs(differX), Math.abs(differY)) === Math.abs(differX);\n    var scrollY = currentTarget.scrollHeight - currentTarget.clientHeight;\n    var scrollX = currentTarget.scrollWidth - currentTarget.clientWidth;\n    /**\n     * <div style=\"height: 300px\">\n     *   <div style=\"height: 900px\"></div>\n     * </div>\n     * 在没设定 overflow: auto 或 scroll 时，currentTarget 里获取不到 scrollTop 或 scrollLeft,\n     * 预先用 scrollTo 来滚动，如果取出的值跟滚动前取出不同，则 currnetTarget 被设定了 overflow; 否则就是上面这种。\n     */\n\n    var t = currentTarget.scrollTop;\n    var l = currentTarget.scrollLeft;\n    currentTarget.scrollTop += 1;\n    currentTarget.scrollLeft += 1;\n    var currentT = currentTarget.scrollTop;\n    var currentL = currentTarget.scrollLeft;\n    currentTarget.scrollTop -= 1;\n    currentTarget.scrollLeft -= 1;\n\n    if (isY && (!scrollY || !(currentT - t) || scrollY && (currentTarget.scrollTop >= scrollY && differY < 0 || currentTarget.scrollTop <= 0 && differY > 0)) || isX && (!scrollX || !(currentL - l) || scrollX && (currentTarget.scrollLeft >= scrollX && differX < 0 || currentTarget.scrollLeft <= 0 && differX > 0))) {\n      return _this4.getTouchParentScroll(root, currentTarget.parentNode, differX, differY);\n    }\n\n    return false;\n  };\n\n  this.domFocus = function (focus) {\n    if (_this4.dom && focus) {\n      _this4.dom.focus();\n    }\n  };\n\n  this.removeStartHandler = function (e) {\n    if (e.touches.length > 1) {\n      return;\n    }\n\n    _this4.startPos = {\n      x: e.touches[0].clientX,\n      y: e.touches[0].clientY\n    };\n  };\n\n  this.removeMoveHandler = function (e) {\n    if (e.changedTouches.length > 1) {\n      return;\n    }\n\n    var currentTarget = e.currentTarget;\n    var differX = e.changedTouches[0].clientX - _this4.startPos.x;\n    var differY = e.changedTouches[0].clientY - _this4.startPos.y;\n\n    if (currentTarget === _this4.maskDom || currentTarget === _this4.handlerDom || currentTarget === _this4.contentDom && _this4.getTouchParentScroll(currentTarget, e.target, differX, differY)) {\n      e.preventDefault();\n    }\n  };\n\n  this.transitionEnd = function (e) {\n    removeEventListener(e.target, transitionEnd, _this4.transitionEnd);\n    e.target.style.transition = '';\n  };\n\n  this.defaultGetContainer = function () {\n    if (windowIsUndefined) {\n      return null;\n    }\n\n    var container = document.createElement('div');\n\n    _this4.parent.appendChild(container);\n\n    if (_this4.props.wrapperClassName) {\n      container.className = _this4.props.wrapperClassName;\n    }\n\n    return container;\n  };\n};\n\nexport default Drawer;","map":{"version":3,"sources":["/Users/majy/work/bici/code/editor-demo/node_modules/rc-drawer/es/Drawer.js"],"names":["_extends","_defineProperty","_objectWithoutProperties","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","React","ReactDOM","PropTypes","classnames","ContainerRender","getScrollBarSize","KeyCode","dataToArray","transitionEnd","transitionStr","addEventListener","removeEventListener","transformArguments","isNumeric","IS_REACT_16","currentDrawer","windowIsUndefined","window","document","createElement","Drawer","_React$PureComponent","props","_this","__proto__","Object","getPrototypeOf","call","_initialiseProps","levelDom","contentDom","maskDom","handlerDom","firstEnter","timeout","drawerId","Number","Date","now","Math","random","toString","replace","round","open","undefined","defaultOpen","state","key","value","componentDidMount","passiveSupported","defineProperty","get","passive","getOpen","handler","getDefault","isOpenChange","forceUpdate","componentWillReceiveProps","nextProps","_this2","placement","getContainer","getContainerBool","container","focus","setState","domFocus","level","getParentAndLevelDom","componentDidUpdate","componentWillUnmount","setLevelDomTransform","body","style","overflow","parentNode","removeChild","clearTimeout","renderComponent","afterClose","removeContainer","onClose","visible","render","_this3","_props","wrapperClassName","children","getChildToRender","className","ref","c","parent","autoMount","autoDestroy","getComponent","_ref","createPortal","PureComponent","propTypes","string","node","object","width","any","height","bool","prefixCls","oneOfType","array","levelMove","number","func","ease","duration","onChange","afterVisibleChange","onMaskClick","onHandleClick","showMask","maskStyle","keyboard","defaultProps","_this4","onMaskTouchEnd","e","onTouchEnd","onIconTouchEnd","close","onKeyDown","keyCode","ESC","_props2","stopPropagation","onWrapperTransitionEnd","target","contentWrapper","propertyName","match","dom","transition","getCurrentDrawerSome","overflowX","left","defaultGetContainer","keys","some","querySelectorAll","HTMLElement","Array","prototype","slice","forEach","child","nodeName","push","item","openTransition","placementName","_props3","right","scrollHeight","innerHeight","documentElement","clientHeight","innerWidth","offsetWidth","levelValue","$levelMove","$value","placementPos","mark","transform","msTransform","eventArray","domArray","widthTransition","transformTransition","touchAction","position","setTimeout","i","removeMoveHandler","removeStartHandler","heightTransition","_classnames","_props4","$wrapperClass","$open","isHorizontal","contentValue","getBoundingClientRect","handlerChildren","cloneElement","onClick","tabIndex","onTransitionEnd","onTouchStart","onTouchMove","getTouchParentScroll","root","currentTarget","differX","differY","isY","max","abs","isX","scrollY","scrollX","scrollWidth","clientWidth","t","scrollTop","l","scrollLeft","currentT","currentL","touches","length","startPos","x","clientX","y","clientY","changedTouches","preventDefault","appendChild"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport ContainerRender from 'rc-util/es/ContainerRender';\nimport getScrollBarSize from 'rc-util/es/getScrollBarSize';\nimport KeyCode from 'rc-util/es/KeyCode';\n\nimport { dataToArray, transitionEnd, transitionStr, addEventListener, removeEventListener, transformArguments, isNumeric } from './utils';\n\nvar IS_REACT_16 = 'createPortal' in ReactDOM;\n\nvar currentDrawer = {};\nvar windowIsUndefined = !(typeof window !== 'undefined' && window.document && window.document.createElement);\n\nvar Drawer = function (_React$PureComponent) {\n  _inherits(Drawer, _React$PureComponent);\n\n  function Drawer(props) {\n    _classCallCheck(this, Drawer);\n\n    var _this = _possibleConstructorReturn(this, (Drawer.__proto__ || Object.getPrototypeOf(Drawer)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.levelDom = [];\n    _this.contentDom = null;\n    _this.maskDom = null;\n    _this.handlerDom = null;\n    _this.firstEnter = props.firstEnter; // 记录首次进入.\n    _this.timeout = null;\n    _this.drawerId = Number((Date.now() + Math.random()).toString().replace('.', Math.round(Math.random() * 9))).toString(16);\n    var open = props.open !== undefined ? props.open : !!props.defaultOpen;\n    currentDrawer[_this.drawerId] = open;\n    _this.state = {\n      open: open\n    };\n    return _this;\n  }\n\n  _createClass(Drawer, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (!windowIsUndefined) {\n        var passiveSupported = false;\n        window.addEventListener('test', null, Object.defineProperty({}, 'passive', {\n          get: function get() {\n            passiveSupported = true;\n            return null;\n          }\n        }));\n        this.passive = passiveSupported ? { passive: false } : false;\n      }\n      var open = this.getOpen();\n      if (this.props.handler || open || this.firstEnter) {\n        this.getDefault(this.props);\n        if (open) {\n          this.isOpenChange = true;\n        }\n        this.forceUpdate();\n      }\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var _this2 = this;\n\n      var open = nextProps.open,\n          placement = nextProps.placement,\n          getContainer = nextProps.getContainer;\n\n      if (open !== undefined && open !== this.props.open) {\n        this.isOpenChange = true;\n        // 没渲染 dom 时，获取默认数据;\n        var getContainerBool = typeof getContainer === 'function' && typeof this.props.getContainer === 'function' ? this.props.getContainer() === getContainer() : this.props.getContainer === getContainer;\n        if (!this.container || !getContainerBool) {\n          this.getDefault(nextProps);\n        }\n        var focus = open && !this.props.open;\n        this.setState({\n          open: open\n        }, function () {\n          _this2.domFocus(focus);\n        });\n      }\n      if (placement !== this.props.placement) {\n        // test 的 bug, 有动画过场，删除 dom\n        this.contentDom = null;\n      }\n      if (this.props.level !== nextProps.level) {\n        this.getParentAndLevelDom(nextProps);\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      // dom 没渲染时，重走一遍。\n      if (!this.firstEnter && this.container) {\n        this.forceUpdate();\n        this.firstEnter = true;\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      delete currentDrawer[this.drawerId];\n      delete this.isOpenChange;\n      if (this.container) {\n        if (this.state.open) {\n          this.setLevelDomTransform(false, true);\n        }\n        document.body.style.overflow = '';\n        // 拦不住。。直接删除；\n        if (this.props.getContainer) {\n          this.container.parentNode.removeChild(this.container);\n        }\n      }\n      this.firstEnter = false;\n      clearTimeout(this.timeout);\n      // suppport react15\n      // 需要 didmount 后也会渲染，直接 unmount 将不会渲染，加上判断.\n      if (this.renderComponent && !IS_REACT_16) {\n        this.renderComponent({\n          afterClose: this.removeContainer,\n          onClose: function onClose() {},\n\n          visible: false\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _props = this.props,\n          getContainer = _props.getContainer,\n          wrapperClassName = _props.wrapperClassName;\n\n      var open = this.getOpen();\n      currentDrawer[this.drawerId] = open ? this.container : open;\n      var children = this.getChildToRender(this.firstEnter ? open : false);\n      if (!getContainer) {\n        return React.createElement(\n          'div',\n          {\n            className: wrapperClassName,\n            ref: function ref(c) {\n              if (_this3.props.getContainer) {\n                return;\n              }\n              _this3.container = c;\n            }\n          },\n          children\n        );\n      }\n      if (!this.container || !open && !this.firstEnter) {\n        return null;\n      }\n      // suppport react15\n      if (!IS_REACT_16) {\n        return React.createElement(\n          ContainerRender,\n          {\n            parent: this,\n            visible: true,\n            autoMount: true,\n            autoDestroy: false,\n            getComponent: function getComponent() {\n              return children;\n            },\n            getContainer: this.getContainer\n          },\n          function (_ref) {\n            var renderComponent = _ref.renderComponent,\n                removeContainer = _ref.removeContainer;\n\n            _this3.renderComponent = renderComponent;\n            _this3.removeContainer = removeContainer;\n            return null;\n          }\n        );\n      }\n      return ReactDOM.createPortal(children, this.container);\n    }\n  }]);\n\n  return Drawer;\n}(React.PureComponent);\n\nDrawer.propTypes = {\n  wrapperClassName: PropTypes.string,\n  className: PropTypes.string,\n  children: PropTypes.node,\n  style: PropTypes.object,\n  width: PropTypes.any,\n  height: PropTypes.any,\n  defaultOpen: PropTypes.bool,\n  firstEnter: PropTypes.bool,\n  open: PropTypes.bool,\n  prefixCls: PropTypes.string,\n  placement: PropTypes.string,\n  level: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n  levelMove: PropTypes.oneOfType([PropTypes.number, PropTypes.func, PropTypes.array]),\n  ease: PropTypes.string,\n  duration: PropTypes.string,\n  getContainer: PropTypes.oneOfType([PropTypes.string, PropTypes.func, PropTypes.object, PropTypes.bool]),\n  handler: PropTypes.any,\n  onChange: PropTypes.func,\n  afterVisibleChange: PropTypes.func,\n  onMaskClick: PropTypes.func,\n  onHandleClick: PropTypes.func,\n  showMask: PropTypes.bool,\n  maskStyle: PropTypes.object,\n  keyboard: PropTypes.bool\n};\nDrawer.defaultProps = {\n  prefixCls: 'drawer',\n  placement: 'left',\n  getContainer: 'body',\n  level: 'all',\n  duration: '.3s',\n  ease: 'cubic-bezier(0.78, 0.14, 0.15, 0.86)',\n  onChange: function onChange() {},\n  afterVisibleChange: function afterVisibleChange() {},\n  handler: React.createElement(\n    'div',\n    { className: 'drawer-handle' },\n    React.createElement('i', { className: 'drawer-handle-icon' })\n  ),\n  firstEnter: false,\n  showMask: true,\n  maskStyle: {},\n  wrapperClassName: '',\n  className: '',\n  keyboard: true\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this4 = this;\n\n  this.onMaskTouchEnd = function (e) {\n    var onMaskClick = _this4.props.onMaskClick;\n\n    if (onMaskClick) {\n      onMaskClick(e);\n    }\n    _this4.onTouchEnd(e, true);\n  };\n\n  this.onIconTouchEnd = function (e) {\n    var onHandleClick = _this4.props.onHandleClick;\n\n    if (onHandleClick) {\n      onHandleClick(e);\n    }\n    _this4.onTouchEnd(e);\n  };\n\n  this.onTouchEnd = function (e, close) {\n    if (_this4.props.open !== undefined) {\n      return;\n    }\n    var open = close || _this4.state.open;\n    _this4.isOpenChange = true;\n    _this4.setState({\n      open: !open\n    }, function () {\n      _this4.domFocus(!open);\n    });\n  };\n\n  this.onKeyDown = function (e) {\n    if (e.keyCode === KeyCode.ESC) {\n      var _props2 = _this4.props,\n          onMaskClick = _props2.onMaskClick,\n          onHandleClick = _props2.onHandleClick;\n\n      e.stopPropagation();\n      var onClose = onHandleClick || onMaskClick;\n      if (onClose) {\n        onClose(e);\n      } else {\n        _this4.onTouchEnd(e, true);\n      }\n    }\n  };\n\n  this.onWrapperTransitionEnd = function (e) {\n    if (e.target === _this4.contentWrapper && e.propertyName.match(/transform$/)) {\n      _this4.dom.style.transition = '';\n      if (!_this4.state.open && _this4.getCurrentDrawerSome()) {\n        document.body.style.overflowX = '';\n        if (_this4.maskDom) {\n          _this4.maskDom.style.left = '';\n          _this4.maskDom.style.width = '';\n        }\n      }\n      var afterVisibleChange = _this4.props.afterVisibleChange;\n      var open = _this4.state.open;\n\n      afterVisibleChange(open);\n    }\n  };\n\n  this.getDefault = function (props) {\n    _this4.getParentAndLevelDom(props);\n    if (props.getContainer || props.parent) {\n      _this4.container = _this4.defaultGetContainer();\n    }\n  };\n\n  this.getCurrentDrawerSome = function () {\n    return !Object.keys(currentDrawer).some(function (key) {\n      return currentDrawer[key];\n    });\n  };\n\n  this.getContainer = function () {\n    return _this4.container;\n  };\n\n  this.getParentAndLevelDom = function (props) {\n    if (windowIsUndefined) {\n      return;\n    }\n    var level = props.level,\n        getContainer = props.getContainer;\n\n    _this4.levelDom = [];\n    if (getContainer) {\n      if (typeof getContainer === 'string') {\n        var dom = document.querySelectorAll(getContainer)[0];\n        _this4.parent = dom;\n      }\n      if (typeof getContainer === 'function') {\n        _this4.parent = getContainer();\n      }\n      if (typeof getContainer === 'object' && getContainer instanceof window.HTMLElement) {\n        _this4.parent = getContainer;\n      }\n    }\n    if (!getContainer && _this4.container) {\n      _this4.parent = _this4.container.parentNode;\n    }\n    if (level === 'all') {\n      var children = Array.prototype.slice.call(_this4.parent.children);\n      children.forEach(function (child) {\n        if (child.nodeName !== 'SCRIPT' && child.nodeName !== 'STYLE' && child.nodeName !== 'LINK' && child !== _this4.container) {\n          _this4.levelDom.push(child);\n        }\n      });\n    } else if (level) {\n      dataToArray(level).forEach(function (key) {\n        document.querySelectorAll(key).forEach(function (item) {\n          _this4.levelDom.push(item);\n        });\n      });\n    }\n  };\n\n  this.setLevelDomTransform = function (open, openTransition, placementName, value) {\n    var _props3 = _this4.props,\n        placement = _props3.placement,\n        levelMove = _props3.levelMove,\n        duration = _props3.duration,\n        ease = _props3.ease,\n        onChange = _props3.onChange,\n        getContainer = _props3.getContainer,\n        showMask = _props3.showMask;\n\n    if (!windowIsUndefined) {\n      var right = document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight) && window.innerWidth > document.body.offsetWidth ? getScrollBarSize(1) : 0;\n      _this4.levelDom.forEach(function (dom) {\n        if (_this4.isOpenChange || openTransition) {\n          /* eslint no-param-reassign: \"error\" */\n          dom.style.transition = 'transform ' + duration + ' ' + ease;\n          addEventListener(dom, transitionEnd, _this4.transitionEnd);\n          var levelValue = open ? value : 0;\n          if (levelMove) {\n            var $levelMove = transformArguments(levelMove, { target: dom, open: open });\n            levelValue = open ? $levelMove[0] : $levelMove[1] || 0;\n          }\n          var $value = typeof levelValue === 'number' ? levelValue + 'px' : levelValue;\n          var placementPos = placement === 'left' || placement === 'top' ? $value : '-' + $value;\n          var mark = placement === 'left' || placement === 'top' ? '-' : '+';\n          placementPos = showMask && (placement === 'left' || placement === 'right') && right ? 'calc(' + placementPos + ' ' + mark + ' ' + right + 'px)' : placementPos;\n          dom.style.transform = levelValue ? placementName + '(' + placementPos + ')' : '';\n          dom.style.msTransform = levelValue ? placementName + '(' + placementPos + ')' : '';\n        }\n      });\n      // 处理 body 滚动\n      if (getContainer === 'body' && showMask) {\n        var eventArray = ['touchstart'];\n        var domArray = [document.body, _this4.maskDom, _this4.handlerDom, _this4.contentDom];\n        var widthTransition = 'width ' + duration + ' ' + ease;\n        var transformTransition = 'transform ' + duration + ' ' + ease;\n        if (open && document.body.style.overflow !== 'hidden') {\n          document.body.style.overflow = 'hidden';\n          document.body.style.touchAction = 'none';\n          if (right) {\n            document.body.style.position = 'relative';\n            document.body.style.width = 'calc(100% - ' + right + 'px)';\n            _this4.dom.style.transition = 'none';\n            switch (placement) {\n              case 'right':\n                _this4.dom.style.transform = 'translateX(-' + right + 'px)';\n                _this4.dom.style.msTransform = 'translateX(-' + right + 'px)';\n                break;\n              case 'top':\n              case 'bottom':\n                _this4.dom.style.width = 'calc(100% - ' + right + 'px)';\n                _this4.dom.style.transform = 'translateZ(0)';\n                break;\n              default:\n                break;\n            }\n            clearTimeout(_this4.timeout);\n            _this4.timeout = setTimeout(function () {\n              _this4.dom.style.transition = transformTransition + ',' + widthTransition;\n              _this4.dom.style.width = '';\n              _this4.dom.style.transform = '';\n              _this4.dom.style.msTransform = '';\n            });\n          }\n          // 手机禁滚\n          domArray.forEach(function (item, i) {\n            if (!item) {\n              return;\n            }\n            addEventListener(item, eventArray[i] || 'touchmove', i ? _this4.removeMoveHandler : _this4.removeStartHandler, _this4.passive);\n          });\n        } else if (_this4.getCurrentDrawerSome()) {\n          document.body.style.overflow = '';\n          document.body.style.touchAction = '';\n          if ((_this4.isOpenChange || openTransition) && right) {\n            document.body.style.position = '';\n            document.body.style.width = '';\n            if (transitionStr) {\n              document.body.style.overflowX = 'hidden';\n            }\n            _this4.dom.style.transition = 'none';\n            var heightTransition = void 0;\n            switch (placement) {\n              case 'right':\n                {\n                  _this4.dom.style.transform = 'translateX(' + right + 'px)';\n                  _this4.dom.style.msTransform = 'translateX(' + right + 'px)';\n                  _this4.dom.style.width = '100%';\n                  widthTransition = 'width 0s ' + ease + ' ' + duration;\n                  if (_this4.maskDom) {\n                    _this4.maskDom.style.left = '-' + right + 'px';\n                    _this4.maskDom.style.width = 'calc(100% + ' + right + 'px)';\n                  }\n                  break;\n                }\n              case 'top':\n              case 'bottom':\n                {\n                  _this4.dom.style.width = 'calc(100% + ' + right + 'px)';\n                  _this4.dom.style.height = '100%';\n                  _this4.dom.style.transform = 'translateZ(0)';\n                  heightTransition = 'height 0s ' + ease + ' ' + duration;\n                  break;\n                }\n              default:\n                break;\n            }\n            clearTimeout(_this4.timeout);\n            _this4.timeout = setTimeout(function () {\n              _this4.dom.style.transition = transformTransition + ',' + (heightTransition ? heightTransition + ',' : '') + widthTransition;\n              _this4.dom.style.transform = '';\n              _this4.dom.style.msTransform = '';\n              _this4.dom.style.width = '';\n              _this4.dom.style.height = '';\n            });\n          }\n          domArray.forEach(function (item, i) {\n            if (!item) {\n              return;\n            }\n            removeEventListener(item, eventArray[i] || 'touchmove', i ? _this4.removeMoveHandler : _this4.removeStartHandler, _this4.passive);\n          });\n        }\n      }\n    }\n    if (_this4.isOpenChange && _this4.firstEnter) {\n      onChange(open);\n      _this4.isOpenChange = false;\n    }\n  };\n\n  this.getChildToRender = function (open) {\n    var _classnames;\n\n    var _props4 = _this4.props,\n        $wrapperClass = _props4.wrapperClassName,\n        className = _props4.className,\n        children = _props4.children,\n        style = _props4.style,\n        width = _props4.width,\n        height = _props4.height,\n        defaultOpen = _props4.defaultOpen,\n        firstEnter = _props4.firstEnter,\n        $open = _props4.open,\n        prefixCls = _props4.prefixCls,\n        placement = _props4.placement,\n        level = _props4.level,\n        levelMove = _props4.levelMove,\n        ease = _props4.ease,\n        duration = _props4.duration,\n        getContainer = _props4.getContainer,\n        handler = _props4.handler,\n        onChange = _props4.onChange,\n        afterVisibleChange = _props4.afterVisibleChange,\n        onMaskClick = _props4.onMaskClick,\n        onHandleClick = _props4.onHandleClick,\n        showMask = _props4.showMask,\n        maskStyle = _props4.maskStyle,\n        keyboard = _props4.keyboard,\n        props = _objectWithoutProperties(_props4, ['wrapperClassName', 'className', 'children', 'style', 'width', 'height', 'defaultOpen', 'firstEnter', 'open', 'prefixCls', 'placement', 'level', 'levelMove', 'ease', 'duration', 'getContainer', 'handler', 'onChange', 'afterVisibleChange', 'onMaskClick', 'onHandleClick', 'showMask', 'maskStyle', 'keyboard']);\n\n    var wrapperClassName = classnames(prefixCls, (_classnames = {}, _defineProperty(_classnames, prefixCls + '-' + placement, true), _defineProperty(_classnames, prefixCls + '-open', open), _defineProperty(_classnames, className, !!className), _defineProperty(_classnames, 'no-mask', !showMask), _classnames));\n    var isOpenChange = _this4.isOpenChange;\n    var isHorizontal = placement === 'left' || placement === 'right';\n    var placementName = 'translate' + (isHorizontal ? 'X' : 'Y');\n    // 百分比与像素动画不同步，第一次打用后全用像素动画。\n    // const defaultValue = !this.contentDom || !level ? '100%' : `${value}px`;\n    var placementPos = placement === 'left' || placement === 'top' ? '-100%' : '100%';\n    var transform = open ? '' : placementName + '(' + placementPos + ')';\n    if (isOpenChange === undefined || isOpenChange) {\n      var contentValue = _this4.contentDom ? _this4.contentDom.getBoundingClientRect()[isHorizontal ? 'width' : 'height'] : 0;\n      var value = (isHorizontal ? width : height) || contentValue;\n      _this4.setLevelDomTransform(open, false, placementName, value);\n    }\n    var handlerChildren = handler && React.cloneElement(handler, {\n      onClick: function onClick(e) {\n        if (handler.props.onClick) {\n          handler.props.onClick();\n        }\n        _this4.onIconTouchEnd(e);\n      },\n      ref: function ref(c) {\n        _this4.handlerDom = c;\n      }\n    });\n    return React.createElement(\n      'div',\n      _extends({}, props, {\n        tabIndex: -1,\n        className: wrapperClassName,\n        style: style,\n        ref: function ref(c) {\n          _this4.dom = c;\n        },\n        onKeyDown: open && keyboard ? _this4.onKeyDown : null,\n        onTransitionEnd: _this4.onWrapperTransitionEnd\n      }),\n      showMask && React.createElement('div', {\n        className: prefixCls + '-mask',\n        onClick: _this4.onMaskTouchEnd,\n        style: maskStyle,\n        ref: function ref(c) {\n          _this4.maskDom = c;\n        }\n      }),\n      React.createElement(\n        'div',\n        {\n          className: prefixCls + '-content-wrapper',\n          style: {\n            transform: transform,\n            msTransform: transform,\n            width: isNumeric(width) ? width + 'px' : width,\n            height: isNumeric(height) ? height + 'px' : height\n          },\n          ref: function ref(c) {\n            _this4.contentWrapper = c;\n          }\n        },\n        React.createElement(\n          'div',\n          {\n            className: prefixCls + '-content',\n            ref: function ref(c) {\n              _this4.contentDom = c;\n            },\n            onTouchStart: open && showMask ? _this4.removeStartHandler : null // 跑用例用\n            , onTouchMove: open && showMask ? _this4.removeMoveHandler : null // 跑用例用\n          },\n          children\n        ),\n        handlerChildren\n      )\n    );\n  };\n\n  this.getOpen = function () {\n    return _this4.props.open !== undefined ? _this4.props.open : _this4.state.open;\n  };\n\n  this.getTouchParentScroll = function (root, currentTarget, differX, differY) {\n    if (!currentTarget || currentTarget === document) {\n      return false;\n    }\n    // root 为 drawer-content 设定了 overflow, 判断为 root 的 parent 时结束滚动；\n    if (currentTarget === root.parentNode) {\n      return true;\n    }\n\n    var isY = Math.max(Math.abs(differX), Math.abs(differY)) === Math.abs(differY);\n    var isX = Math.max(Math.abs(differX), Math.abs(differY)) === Math.abs(differX);\n\n    var scrollY = currentTarget.scrollHeight - currentTarget.clientHeight;\n    var scrollX = currentTarget.scrollWidth - currentTarget.clientWidth;\n    /**\n     * <div style=\"height: 300px\">\n     *   <div style=\"height: 900px\"></div>\n     * </div>\n     * 在没设定 overflow: auto 或 scroll 时，currentTarget 里获取不到 scrollTop 或 scrollLeft,\n     * 预先用 scrollTo 来滚动，如果取出的值跟滚动前取出不同，则 currnetTarget 被设定了 overflow; 否则就是上面这种。\n     */\n    var t = currentTarget.scrollTop;\n    var l = currentTarget.scrollLeft;\n    currentTarget.scrollTop += 1;\n    currentTarget.scrollLeft += 1;\n    var currentT = currentTarget.scrollTop;\n    var currentL = currentTarget.scrollLeft;\n    currentTarget.scrollTop -= 1;\n    currentTarget.scrollLeft -= 1;\n    if (isY && (!scrollY || !(currentT - t) || scrollY && (currentTarget.scrollTop >= scrollY && differY < 0 || currentTarget.scrollTop <= 0 && differY > 0)) || isX && (!scrollX || !(currentL - l) || scrollX && (currentTarget.scrollLeft >= scrollX && differX < 0 || currentTarget.scrollLeft <= 0 && differX > 0))) {\n      return _this4.getTouchParentScroll(root, currentTarget.parentNode, differX, differY);\n    }\n    return false;\n  };\n\n  this.domFocus = function (focus) {\n    if (_this4.dom && focus) {\n      _this4.dom.focus();\n    }\n  };\n\n  this.removeStartHandler = function (e) {\n    if (e.touches.length > 1) {\n      return;\n    }\n    _this4.startPos = {\n      x: e.touches[0].clientX,\n      y: e.touches[0].clientY\n    };\n  };\n\n  this.removeMoveHandler = function (e) {\n    if (e.changedTouches.length > 1) {\n      return;\n    }\n    var currentTarget = e.currentTarget;\n    var differX = e.changedTouches[0].clientX - _this4.startPos.x;\n    var differY = e.changedTouches[0].clientY - _this4.startPos.y;\n    if (currentTarget === _this4.maskDom || currentTarget === _this4.handlerDom || currentTarget === _this4.contentDom && _this4.getTouchParentScroll(currentTarget, e.target, differX, differY)) {\n      e.preventDefault();\n    }\n  };\n\n  this.transitionEnd = function (e) {\n    removeEventListener(e.target, transitionEnd, _this4.transitionEnd);\n    e.target.style.transition = '';\n  };\n\n  this.defaultGetContainer = function () {\n    if (windowIsUndefined) {\n      return null;\n    }\n    var container = document.createElement('div');\n    _this4.parent.appendChild(container);\n    if (_this4.props.wrapperClassName) {\n      container.className = _this4.props.wrapperClassName;\n    }\n    return container;\n  };\n};\n\nexport default Drawer;"]},"metadata":{},"sourceType":"module"}